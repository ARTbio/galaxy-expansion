# This file is managed by Ansible.
# Do not edit this file manually. Any changes will be automatically reverted.

runners:
  local:
    load: galaxy.jobs.runners.local:LocalJobRunner
    workers: 4
  slurm:
    load: galaxy.jobs.runners.slurm:SlurmJobRunner
    workers: 4
    params:
      drmaa_library_path: /usr/lib/slurm-drmaa/lib/libdrmaa.so

handling:
  assign: db-skip-locked

execution:
  default: local
  environments:
    local:
      runner: local
    gce_multicore:
      runner: local
      local_slots: 2
      embed_metadata_in_job: true
    bowtie:
      runner: local
      local_slots: 4
    cluster:
      runner: slurm
      env:
        - file: /home/galaxy/galaxy/.venv/bin/activate
      params:
        nativeSpecification: "--partition=debug --ntasks=4"

limits:
  - type: anonymous_user_concurrent_jobs
    value: '1'
  - type: registered_user_concurrent_jobs
    value: '3'
  - type: destination_user_concurrent_jobs
    id: bowtie
    value: '1'

tools:

  - id: "upload1"
    destination: "local"
  - id: "__DATA_FETCH__"
    destination: "local"
  - id "__SET_METADATA__"
    destination: "local"

  - id: "sam_to_bam"
    destination: "gce_multicore"

  - id: "sambamba_sample_or_filter"
    destination: "gce_multicore"

  - id: "bowtie"
    destination: "bowtie"

  - id: "bowtie_wrapper"
    destination: "bowtie"

  - id: "bowtie2"
    destination: "bowtie"

  - id: "bowtieForSmallRNA"
    destination: "bowtie"

  - id: "bowtie_wrapper"
    destination: "gce_multicore"

  - id: "mircounts"
    destination: "gce_multicore"

  - id: "picard_SamToFastq"
    destination: "gce_multicore" 

  - id: "rna_star"
    destination: "gce_multicore"

  - id: "rna_starsolo"
    destination: "gce_multicore"

  - id: "samtools_cram_to_bam"
    destination: "gce_multicore"

  - id: "samtools_slice_bam"
    destination: "gce_multicore"

  - id: "samtools_view"
    destination: "gce_multicore"

  - id: "samtools_rmdup"
    destination: "gce_multicore"

  - id: "samtools_fastx"
    destination: "gce_multicore"

  - id: "samtool_filter2"
    destination: "gce_multicore"

  - id: "small_rna_maps"
    destination: "gce_multicore"

  - id: "sr_bowtie_dataset_annotation"
    destination: "bowtie"

  - id: "bowtie_index_builder_data_manager"
    destination: "gce_multicore"

  - id: "retrieve_fasta_from_NCBI"
    destination: "cluster_4"
